<!-- <ngx-spinner
  [fullScreen]="true"
  size="medium"
  type="ball-clip-rotate-multiple"
  color="white"
  bdColor="rgba(0, 0, 0, 0.8)"
>
  <p style="color: white">Processing...</p>
</ngx-spinner> -->
<ngx-spinner
  [fullScreen]="true"
  size="medium"
  type="ball-clip-rotate-multiple"
  color="black"
  bdColor="rgba(255, 255, 255, 1)"
>
  <p style="color: black">Processing...</p>
</ngx-spinner>

<div class="app-container">
  <div class="header">
    <span class="logo">
      <img src="/assets/logo.png" height="50px" width="80px" alt="logo" />
    </span>
    <!-- <h1 class="pozpro">Grant Writing</h1> -->

    <div class="avatar-container">
      <span type="button">
        <!-- <mat-icon>account_circle</mat-icon> -->
        <p-avatar
          icon="pi pi-user"
          styleClass="mr-2"
          shape="circle"
          (click)="toggleSidenav()"
        ></p-avatar>
      </span>
    </div>
  </div>
  <div class="chat-container" *ngIf="!showChat">
    <div class="intro-page">
      <img src="assets/chat-logo.png" alt="Chat Logo" class="chat-logo" />
      <h2>Welcome to Query Chat</h2>
      <p>
        This project allows you to ask any query, and it fetches answers along
        with relevant documents.
      </p>
      <button class="start-chat-btn" (click)="startChat()">Start Chat</button>
    </div>
  </div>

  <!-- Chat Interface -->
  <div class="chat-interface" *ngIf="showChat">
    <div class="chat-header">
      <h2>Query Chat</h2>
    </div>
    <div class="chat-messages" #chatScroll>
      <div class="message-container user-message" *ngFor="let msg of messages">
  <div class="message-left">
    <p class="message"><strong>User:</strong> {{ msg.query }}</p>
  </div>

  <div class="message-right">
    <p class="message"><strong>Answer:</strong> {{ msg.answer }}</p>
  </div>

        <div class="document-scroller">

          <!-- Document Cards Container -->
          <div class="card-container">
            <div *ngFor="let doc of msg.documents" class="card shadow-2">
              <a href="{{ doc }}" class="download-link" download>Download Related Document</a>
            </div>
          </div>

        </div>

      </div>
    </div>

    <div class="chat-input-container">
      <input
        [(ngModel)]="userQuery"
        class="chat-input"
        placeholder="Type your query here..."
      />
      <button (click)="sendQuery()" class="send-btn">
        <mat-icon>send</mat-icon>
      </button>
    </div>
  </div>
  <!-- doc -->
  <div class="content">
    <div *ngIf="progress > 0 && progress < 100">
      <mat-progress-bar
        mode="determinate"
        [value]="progress"
      ></mat-progress-bar>
      <p>Uploading... {{ progress }}%</p>
    </div>
  </div>

  <div class="footer">
    <p class="copyright">&copy; 2024 Pozent Project</p>
  </div>

  <p-sidebar [(visible)]="isSidenavOpen" position="right" class="sidenav">
    <h3>{{ email }}</h3>
    <!-- PrimeNG Button for Logout -->
    <button
      pButton
      class="LOG"
      label="Logout"
      pRipple
      (click)="logout()"
    ></button>

    <!-- Toast component to show top-left messages -->
    <p-toast key="tl" position="top-left"></p-toast>
  </p-sidebar>
</div>
